<div class="cv">
  <div
    *ngIf="data"
    [class]="data.theme.class">

    <div class="details">
      <div
        (click)="editField($event, data.details, 'name')"
        class="editable name">{{ data.details.name }}</div>

      <div>
        <div
          (click)="editField($event, data.details, 'address')"
          class="editable address">{{ data.details.address }}</div>
        <div

          (click)="editField($event, data.details, 'tel')"
          class="editable tel">
          {{ data.details.tel }}
        </div>
      </div>

      <div>
        <a
          (click)="editField($event, data.details, 'email')"
          class="editable email"
          [attr.href]="'mailto:' + data.details.email">
          {{ data.details.email }}
        </a>

        <a
          (click)="editField($event, data.details, 'url')"
          class="editable url"
          [attr.href]="data.details.url"
          target="_blank">
          {{ data.details.url }}
        </a>
      </div>
    </div>

    <div class="items">
      <div
        *ngFor="let item of data.items"
        class="item">
        <div
          *ngIf="item.class === TYPES.TEXT"
          [class]="item.class">
          <div
            (click)="editField($event, item, 'title')"
            class="editable title">
            {{ item.title }}
          </div>
          <div
            (click)="editField($event, item, 'content')"
            class="editable content">
            {{ item.content }}
          </div>
        </div>

        <div
          *ngIf="item.class === TYPES.EXPERIENCE"
          [class]="item.class">
          <div
            (click)="editField($event, item, 'title')"
            class="editable title">
            {{ item.title }}
          </div>

          <div
            *ngFor="let child of item.items"
            class="child">
            <div class="left">
              <div
                (click)="editField($event, child, 'title')"
                class="editable title">
                {{ child.title }}
              </div>

              <div class="timespan">
                <div
                  (click)="editField($event, child, 'start')"
                  class="editable start">
                  {{ child.start }}
                </div>
                <div
                  (click)="editField($event, child, 'end')"
                  class="editable end">
                  {{ child.end ? child.end : CONSTANTS.UNTIL_NOW }}
                </div>
              </div>
            </div>

            <div class="right">
              <a
                (click)="editField($event, child, 'link')"
                class="editable institution"
                [attr.href]="child.link"
                target="_blank">
                {{ child.institution }}
              </a>

              <div
                (click)="editField($event, child, 'location')"
                class="editable location">
                {{ child.location }}
              </div>
              <div
                (click)="editField($event, child, 'description')"
                class="editable description">
                {{ child.description }}
              </div>

              <div class="tags">
                <div
                  (click)="editField($event, tag, 'name')"
                  class="editable tag"
                  *ngFor="let tag of child.tags">
                  {{ tag.name }}
                </div>
              </div>
            </div>
          </div>
        </div>

        <div
          *ngIf="item.class === TYPES.EDUCATION"
          [class]="item.class">
          <div
            (click)="editField($event, item, 'title')"
            class="editable title">
            {{ item.title }}
          </div>

          <div
            *ngFor="let child of item.items"
            class="child">

            <div class="left">
              <div
                (click)="editField($event, child, 'title')"
                class="editable title">
                {{ child.title }}
              </div>

              <div class="timespan">
                <div
                  (click)="editField($event, child, 'start')"
                  class="editable start">
                  {{ child.start }}
                </div>
                <div
                  (click)="editField($event, child, 'end')"
                  class="editable end">
                  {{ child.end ? child.end : CONSTANTS.UNTIL_NOW }}
                </div>
              </div>
            </div>

            <div class="right">
              <a
                (click)="editField($event, child, 'link')"
                class="editable institution"
                [attr.href]="child.link"
                target="_blank">
                {{ child.institution }}
              </a>

              <div
                (click)="editField($event, child, 'location')"
                class="editable location">
                {{ child.location }}
              </div>
              <div
                (click)="editField($event, child, 'description')"
                class="editable description">
                {{ child.description }}
              </div>
              <div
                (click)="editField($event, child, 'field')"
                class="editable field">
                {{ child.field }}
              </div>
              <div
                (click)="editField($event, child, 'grade')"
                class="editable grade">
                {{ child.grade }}
              </div>
            </div>
          </div>
        </div>

        <div
          *ngIf="item.class === TYPES.SKILLS"
          [class]="item.class">
          <div
            (click)="editField($event, item, 'title')"
            class="editable title">
            {{ item.title }}
          </div>

          <div
            *ngFor="let child of item.items"
            class="child">
            <div
              (click)="editField($event, child, 'title')"
              class="editable title">
              {{ child.title }}
            </div>

            <div class="bar">
              <div
                *ngIf="child.percentage"
                (click)="editField($event, child, 'percentage')"
                class="editable wrapper">
                <div
                  class="percentage"
                  [style.width]="child.percentage * 100 + '%'">
                </div>
              </div>

              <div
                *ngIf="child.description"
                (click)="editField($event, child, 'description')"
                class="editable description">
                {{ child.description }}
              </div>
            </div>
          </div>
        </div>

        <div
          *ngIf="item.class === TYPES.DETAIL_LIST"
          [class]="item.class">
          <div
            (click)="editField($event, item, 'title')"
            class="editable title">
            {{ item.title }}
          </div>

          <div
            *ngFor="let child of item.items"
            class="child">

            <div class="left">
              <div
                (click)="editField($event, child, 'title')"
                class="editable title">
                {{ child.title }}
              </div>

              <div class="timespan">
                <div
                  *ngIf="child.start"
                  (click)="editField($event, child, 'start')"
                  class="editable start">{{ child.start }}
                </div>
                <div
                  (click)="editField($event, child, 'end')"
                  class="editable end">{{ child.end ? child.end : CONSTANTS.UNTIL_NOW }}</div>
              </div>
            </div>

            <div class="right">
              <a
                *ngIf="child.institution"
                (click)="editField($event, child, 'institution')"
                class="editable institution"
                [attr.href]="child.link"
                target="_blank">{{ child.institution }}</a>

              <div
                *ngIf="child.location"
                (click)="editField($event, child, 'location')"
                class="editable location">{{ child.location }}</div>

              <div
                (click)="editField($event, child, 'description')"
                class="editable description">{{ child.description }}</div>

              <div class="tags">
                <div
                  (click)="editField($event, tag, 'name')"
                  *ngFor="let tag of child.tags"
                  class="editable tag">
                  {{ tag.name }}
                </div>
              </div>
            </div>
          </div>
        </div>

        <div
          *ngIf="item.class === TYPES.RECOMMENDATION"
          [class]="item.class">
          <div
            (click)="editField($event, item, 'title')"
            class="editable title">
            {{ item.title }}
          </div>

          <div
            *ngFor="let child of item.items"
            class="child">
            <div
              (click)="editField($event, child, 'name')"
              class="editable name">
              {{ child.name }}
            </div>
            <div
              (click)="editField($event, child, 'relationship')"
              class="editable relationship">
              {{ child.relationship }}
            </div>
            <div
              (click)="editField($event, child, 'institution')"
              class="editable institution">
              {{ child.institution }}
            </div>
            <div
              (click)="editField($event, child, 'comment')"
              class="editable comment">
              {{ child.comment }}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div
  #inputWrapper
  class="input-wrapper">

  <textarea
    #textarea
    (change)="updateTextAreaHeight()"
    (cut)="delayedUpdateTextAreaHeight()"
    (paste)="delayedUpdateTextAreaHeight()"
    (drop)="delayedUpdateTextAreaHeight()"
    (keydown)="delayedUpdateTextAreaHeight()">
  </textarea>

  <div class="buttons">
    <button
      (click)="cancelEdit()">Cancel</button>
    <button
      (click)="saveChanges()">Save</button>
  </div>
</div>
